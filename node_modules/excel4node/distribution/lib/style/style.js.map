{"version":3,"file":"style.js","names":["utils","require","deepmerge","Alignment","Border","Fill","Font","NumberFormat","_getFontId","wb","font","opts","defaultFont","thisFont","lookupKey","JSON","stringify","toObject","id","styleDataLookup","fonts","undefined","styleData","push","_getFillId","fill","thisFill","fills","_getBorderId","border","thisBorder","borders","_getNumFmt","val","fmt","numFmts","forEach","f","formatCode","fmtId","length","numFmtId","Style","styles","alignment","borderId","fillId","fontId","numberFormat","numFmt","pivotButton","quotePrefix","ids","thisXF","applyFont","applyFill","applyBorder","applyNumberFormat","applyAlignment","obj","ele","thisEle","xf","Object","keys","a","addToXMLele","att","module","exports"],"sources":["../../../source/lib/style/style.js"],"sourcesContent":["const utils = require('../utils.js');\nconst deepmerge = require('deepmerge');\n\nconst Alignment = require('./classes/alignment.js');\nconst Border = require('./classes/border.js');\nconst Fill = require('./classes/fill.js');\nconst Font = require('./classes/font.js');\nconst NumberFormat = require('./classes/numberFormat.js');\n\nlet _getFontId = (wb, font = {}) => {\n\n    // Create the Font and lookup key\n    font = deepmerge(wb.opts.defaultFont, font);\n    const thisFont = new Font(font);\n    const lookupKey = JSON.stringify(thisFont.toObject());\n\n    // Find an existing entry, creating a new one if it does not exist\n    let id = wb.styleDataLookup.fonts[lookupKey];\n    if (id === undefined) {\n        id = wb.styleData.fonts.push(thisFont) - 1;\n        wb.styleDataLookup.fonts[lookupKey] = id;\n    }\n\n    return id;\n};\n\nlet _getFillId = (wb, fill) => {\n    if (fill === undefined) {\n        return null;\n    }\n\n    // Create the Fill and lookup key\n    const thisFill = new Fill(fill);\n    const lookupKey = JSON.stringify(thisFill.toObject());\n\n    // Find an existing entry, creating a new one if it does not exist\n    let id = wb.styleDataLookup.fills[lookupKey];\n    if (id === undefined) {\n        id = wb.styleData.fills.push(thisFill) - 1;\n        wb.styleDataLookup.fills[lookupKey] = id;\n    }\n\n    return id;\n};\n\nlet _getBorderId = (wb, border) => {\n    if (border === undefined) {\n        return null;\n    }\n\n    // Create the Border and lookup key\n    const thisBorder = new Border(border);\n    const lookupKey = JSON.stringify(thisBorder.toObject());\n\n    // Find an existing entry, creating a new one if it does not exist\n    let id = wb.styleDataLookup.borders[lookupKey];\n    if (id === undefined) {\n        id = wb.styleData.borders.push(thisBorder) - 1;\n        wb.styleDataLookup.borders[lookupKey] = id;\n    }\n\n    return id;\n};\n\nlet _getNumFmt = (wb, val) => {\n    let fmt;\n    wb.styleData.numFmts.forEach((f) => {\n        if (f.formatCode === val) {\n            fmt = f;\n        }\n    });\n\n    if (fmt === undefined) {\n        let fmtId = wb.styleData.numFmts.length + 164;\n        fmt = new NumberFormat(val);\n        fmt.numFmtId = fmtId;\n        wb.styleData.numFmts.push(fmt);\n    }\n\n    return fmt;\n};\n\n\n/*\n    Style Opts\n    {\n        alignment: { // §18.8.1\n            horizontal: ['center', 'centerContinuous', 'distributed', 'fill', 'general', 'justify', 'left', 'right'],\n            indent: integer, // Number of spaces to indent = indent value * 3\n            justifyLastLine: boolean,\n            readingOrder: ['contextDependent', 'leftToRight', 'rightToLeft'], \n            relativeIndent: integer, // number of additional spaces to indent\n            shrinkToFit: boolean,\n            textRotation: integer, // number of degrees to rotate text counter-clockwise\n            vertical: ['bottom', 'center', 'distributed', 'justify', 'top'],\n            wrapText: boolean\n        },\n        font: { // §18.8.22\n            bold: boolean,\n            charset: integer,\n            color: string,\n            condense: boolean,\n            extend: boolean,\n            family: string,\n            italics: boolean,\n            name: string,\n            outline: boolean,\n            scheme: string, // §18.18.33 ST_FontScheme (Font scheme Styles)\n            shadow: boolean,\n            strike: boolean,\n            size: integer,\n            underline: boolean,\n            vertAlign: string // §22.9.2.17 ST_VerticalAlignRun (Vertical Positioning Location)\n        },\n        border: { // §18.8.4 border (Border)\n            left: {\n                style: string,\n                color: string\n            },\n            right: {\n                style: string,\n                color: string\n            },\n            top: {\n                style: string,\n                color: string\n            },\n            bottom: {\n                style: string,\n                color: string\n            },\n            diagonal: {\n                style: string,\n                color: string\n            },\n            diagonalDown: boolean,\n            diagonalUp: boolean,\n            outline: boolean\n        },\n        fill: { // §18.8.20 fill (Fill)\n            type: 'pattern',\n            patternType: 'solid',\n            color: 'Yellow'\n        },\n        numberFormat: integer or string // §18.8.30 numFmt (Number Format)\n    }\n*/\nclass Style {\n    constructor(wb, opts) {\n        /**\n         * Excel Style object\n         * @class Style\n         * @desc Style object for formatting Excel Cells\n         * @param {Workbook} wb Excel Workbook object\n         * @param {Object} opts Options for style\n         * @param {Object} opts.alignment Options for creating an Alignment instance\n         * @param {Object} opts.font Options for creating a Font instance\n         * @param {Object} opts.border Options for creating a Border instance\n         * @param {Object} opts.fill Options for creating a Fill instance\n         * @param {String} opts.numberFormat\n         * @property {Alignment} alignment Alignment instance associated with Style\n         * @property {Border} border Border instance associated with Style\n         * @property {Number} borderId ID of Border instance in the Workbook\n         * @property {Fill} fill Fill instance associated with Style\n         * @property {Number} fillId ID of Fill instance in the Workbook\n         * @property {Font} font Font instance associated with Style\n         * @property {Number} fontId ID of Font instance in the Workbook\n         * @property {String} numberFormat String represenation of the way a number should be formatted\n         * @property {Number} xf XF id of the Style in the Workbook\n         * @returns {Style} \n         */\n        opts = opts ? opts : {};\n        opts = deepmerge(wb.styles[0] ? wb.styles[0] : {}, opts);\n\n        if (opts.alignment !== undefined) {\n            this.alignment = new Alignment(opts.alignment);\n        }\n\n        if (opts.border !== undefined) {\n            this.borderId = _getBorderId(wb, opts.border); // attribute 0 based index\n            this.border = wb.styleData.borders[this.borderId];\n        }\n        if (opts.fill !== undefined) {\n            this.fillId = _getFillId(wb, opts.fill); // attribute 0 based index\n            this.fill = wb.styleData.fills[this.fillId];\n        }\n\n        if (opts.font !== undefined) {\n            this.fontId = _getFontId(wb, opts.font); // attribute 0 based index\n            this.font = wb.styleData.fonts[this.fontId];\n        }\n\n        if (opts.numberFormat !== undefined) {\n            if (typeof opts.numberFormat === 'number' && opts.numberFormat <= 164) {\n                this.numFmtId = opts.numberFormat;\n            } else if (typeof opts.numberFormat === 'string') {\n                this.numFmt = _getNumFmt(wb, opts.numberFormat);\n            }\n        }\n\n        if (opts.pivotButton !== undefined) {\n            this.pivotButton = null; // attribute boolean\n        }\n\n        if (opts.quotePrefix !== undefined) {\n            this.quotePrefix = null; // attribute boolean\n        }\n\n        this.ids = {};\n    }\n\n    get xf() {\n        let thisXF = {};\n\n        if (typeof this.fontId === 'number') {\n            thisXF.applyFont = 1;\n            thisXF.fontId = this.fontId;\n        }\n\n        if (typeof this.fillId === 'number') {\n            thisXF.applyFill = 1;\n            thisXF.fillId = this.fillId;\n        }\n\n        if (typeof this.borderId === 'number') {\n            thisXF.applyBorder = 1;\n            thisXF.borderId = this.borderId;\n        }\n\n        if (typeof this.numFmtId === 'number') {\n            thisXF.applyNumberFormat = 1;\n            thisXF.numFmtId = this.numFmtId;\n        } else if (this.numFmt !== undefined && this.numFmt !== null) {\n            thisXF.applyNumberFormat = 1;\n            thisXF.numFmtId = this.numFmt.numFmtId;\n        }\n\n        if (this.alignment instanceof Alignment) {\n            thisXF.applyAlignment = 1;\n            thisXF.alignment = this.alignment;\n        }\n\n        return thisXF;\n    }\n\n\n    /** \n     * @func Style.toObject\n     * @desc Converts the Style instance to a javascript object\n     * @returns {Object}\n     */\n    toObject() {\n        let obj = {};\n\n        if (typeof this.fontId === 'number') {\n            obj.font = this.font.toObject();\n        }\n\n        if (typeof this.fillId === 'number') {\n            obj.fill = this.fill.toObject();\n        }\n\n        if (typeof this.borderId === 'number') {\n            obj.border = this.border.toObject();\n        }\n\n        if (typeof this.numFmtId === 'number' && this.numFmtId < 164) {\n            obj.numberFormat = this.numFmtId;\n        } else if (this.numFmt !== undefined && this.numFmt !== null) {\n            obj.numberFormat = this.numFmt.formatCode;\n        }\n\n        if (this.alignment instanceof Alignment) {\n            obj.alignment = this.alignment.toObject();\n        }\n\n        if (this.pivotButton !== undefined) {\n            obj.pivotButton = this.pivotButton;\n        }\n\n        if (this.quotePrefix !== undefined) {\n            obj.quotePrefix = this.quotePrefix;\n        }\n\n        return obj;\n    }\n\n    /**\n     * @alias Style.addToXMLele\n     * @desc When generating Workbook output, attaches style to the styles xml file\n     * @func Style.addToXMLele\n     * @param {xmlbuilder.Element} ele Element object of the xmlbuilder module\n     */\n    addXFtoXMLele(ele) {\n        let thisEle = ele.ele('xf');\n        let thisXF = this.xf;\n        Object.keys(thisXF).forEach((a) => {\n            if (a === 'alignment') {\n                thisXF[a].addToXMLele(thisEle);\n            } else {\n                thisEle.att(a, thisXF[a]);\n            }\n        });\n    }\n\n    /**\n     * @alias Style.addDXFtoXMLele\n     * @desc When generating Workbook output, attaches style to the styles xml file as a dxf for use with conditional formatting rules\n     * @func Style.addDXFtoXMLele\n     * @param {xmlbuilder.Element} ele Element object of the xmlbuilder module\n     */\n    addDXFtoXMLele(ele) {\n        let thisEle = ele.ele('dxf');\n\n        if (this.font instanceof Font) {\n            this.font.addToXMLele(thisEle);\n        }\n\n        if (this.numFmt instanceof NumberFormat) {\n            this.numFmt.addToXMLele(thisEle);\n        }\n\n        if (this.fill instanceof Fill) {\n            this.fill.addToXMLele(thisEle.ele('fill'));\n        }\n\n        if (this.alignment instanceof Alignment) {\n            this.alignment.addToXMLele(thisEle);\n        }\n\n        if (this.border instanceof Border) {\n            this.border.addToXMLele(thisEle);\n        }\n    }\n}\n\nmodule.exports = Style;"],"mappings":"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,GAAeF,KAAf;IACA9B,EAAE,CAACa,SAAH,CAAaa,OAAb,CAAqBZ,IAArB,CAA0BW,GAA1B;EACH;;EAED,OAAOA,GAAP;AACH,CAhBD;AAmBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;IACMQ,K;EACF,eAAYjC,EAAZ,EAAgBE,IAAhB,EAAsB;IAAA;;IAClB;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IACQA,IAAI,GAAGA,IAAI,GAAGA,IAAH,GAAU,EAArB;IACAA,IAAI,GAAGT,SAAS,CAACO,EAAE,CAACkC,MAAH,CAAU,CAAV,IAAelC,EAAE,CAACkC,MAAH,CAAU,CAAV,CAAf,GAA8B,EAA/B,EAAmChC,IAAnC,CAAhB;;IAEA,IAAIA,IAAI,CAACiC,SAAL,KAAmBvB,SAAvB,EAAkC;MAC9B,KAAKuB,SAAL,GAAiB,IAAIzC,SAAJ,CAAcQ,IAAI,CAACiC,SAAnB,CAAjB;IACH;;IAED,IAAIjC,IAAI,CAACkB,MAAL,KAAgBR,SAApB,EAA+B;MAC3B,KAAKwB,QAAL,GAAgBjB,YAAY,CAACnB,EAAD,EAAKE,IAAI,CAACkB,MAAV,CAA5B,CAD2B,CACoB;;MAC/C,KAAKA,MAAL,GAAcpB,EAAE,CAACa,SAAH,CAAaS,OAAb,CAAqB,KAAKc,QAA1B,CAAd;IACH;;IACD,IAAIlC,IAAI,CAACc,IAAL,KAAcJ,SAAlB,EAA6B;MACzB,KAAKyB,MAAL,GAActB,UAAU,CAACf,EAAD,EAAKE,IAAI,CAACc,IAA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"}