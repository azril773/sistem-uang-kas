{"version":3,"file":"fill.js","names":["types","require","xmlbuilder","CTColor","Stop","opts","position","color","obj","undefined","toObject","Fill","indexOf","type","TypeError","bottom","degree","left","right","top","stops","Array","forEach","s","i","push","bgColor","fgColor","patternType","fillPattern","validate","stop","fXML","pFill","ele","att","module","exports"],"sources":["../../../../source/lib/style/classes/fill.js"],"sourcesContent":["const types = require('../../types/index.js');\nconst xmlbuilder = require('xmlbuilder');\nconst CTColor = require('./ctColor.js');\n\nclass Stop { //ยง18.8.38\n    /** \n     * @class Stop\n     * @desc Stops for Gradient fills\n     * @param {Object} opts Options for Stop\n     * @param {String} opts.color Color of Stop\n     * @param {Number} opts.position Order of Stop with first stop being 0\n     * @returns {Stop}\n     */\n    constructor(opts, position) {\n        this.color = new CTColor(opts.color);\n        this.position = position;\n    }\n\n    /** \n     * @func Stop.toObject\n     * @desc Converts the Stop instance to a javascript object\n     * @returns {Object}\n     */\n    toObject() {\n        let obj = {};\n        this.color !== undefined ? obj.color = this.color.toObject() : null;\n        this.position !== undefined ? obj.position = this.position : null;\n        return obj;\n    }\n}\n\nclass Fill { //ยง18.8.20 fill (Fill)\n\n    /** \n     * @class Fill\n     * @desc Excel Fill \n     * @param {Object} opts\n     * @param {String} opts.type Type of Excel fill (gradient or pattern)\n     * @param {Number} opts.bottom If Gradient fill, the position of the bottom edge of the inner rectange as a percentage in decimal form. (must be between 0 and 1)\n     * @param {Number} opts.top If Gradient fill, the position of the top edge of the inner rectange as a percentage in decimal form. (must be between 0 and 1)\n     * @param {Number} opts.left If Gradient fill, the position of the left edge of the inner rectange as a percentage in decimal form. (must be between 0 and 1)\n     * @param {Number} opts.right If Gradient fill, the position of the right edge of the inner rectange as a percentage in decimal form. (must be between 0 and 1)\n     * @param {Number} opts.degree Angle of the Gradient\n     * @param {Array.Stop} opts.stops Array of position stops for gradient\n     * @returns {Fill}\n     */\n    constructor(opts) {\n\n        if (['gradient', 'pattern', 'none'].indexOf(opts.type) >= 0) {\n            this.type = opts.type;\n        } else {\n            throw new TypeError('Fill type must be one of gradient, pattern or none.');\n        }\n\n        switch (this.type) {\n            case 'gradient': //ยง18.8.24\n                if (opts.bottom !== undefined) {\n                    if (opts.bottom < 0 || opts.bottom > 1) {\n                        throw new TypeError('Values for gradient fill bottom attribute must be a decimal between 0 and 1');\n                    } else {\n                        this.bottom = opts.bottom;\n                    }\n                }\n\n                if (opts.degree !== undefined) {\n                    if (typeof opts.degree === 'number') {\n                        this.degree = opts.degree;\n                    } else {\n                        throw new TypeError('Values of gradient fill degree must be of type number.');\n                    }\n                }\n\n\n                if (opts.left !== undefined) {\n                    if (opts.left < 0 || opts.left > 1) {\n                        throw new TypeError('Values for gradient fill left attribute must be a decimal between 0 and 1');\n                    } else {\n                        this.left = opts.left;\n                    }\n                }\n\n                if (opts.right !== undefined) {\n                    if (opts.right < 0 || opts.right > 1) {\n                        throw new TypeError('Values for gradient fill right attribute must be a decimal between 0 and 1');\n                    } else {\n                        this.right = opts.right;\n                    }\n                }\n\n                if (opts.top !== undefined) {\n                    if (opts.top < 0 || opts.top > 1) {\n                        throw new TypeError('Values for gradient fill top attribute must be a decimal between 0 and 1');\n                    } else {\n                        this.top = opts.top;\n                    }\n                }\n\n                if (opts.stops !== undefined) {\n                    if (opts.stops instanceof Array) {\n                        opts.stops.forEach((s, i) => {\n                            this.stops.push(new Stop(s, i));\n                        });\n                    } else {\n                        throw new TypeError('Stops for gradient fills must be sent as an Array');\n                    }\n                }\n\n                break;\n\n            case 'pattern': //ยง18.8.32\n                if (opts.bgColor !== undefined) {\n                    this.bgColor = new CTColor(opts.bgColor);\n                }\n\n                if (opts.fgColor !== undefined) {\n                    this.fgColor = new CTColor(opts.fgColor);\n                }\n\n                if (opts.patternType !== undefined) {\n                    types.fillPattern.validate(opts.patternType) === true ? this.patternType = opts.patternType : null;\n                }\n                break;\n\n            case 'none':\n                this.patternType = 'none';\n                break;\n        }\n    }\n\n    /** \n     * @func Fill.toObject\n     * @desc Converts the Fill instance to a javascript object\n     * @returns {Object}\n     */\n    toObject() {\n        let obj = {};\n\n        this.type !== undefined ? obj.type = this.type : null;\n        this.bottom !== undefined ? obj.bottom = this.bottom : null;\n        this.degree !== undefined ? obj.degree = this.degree : null;\n        this.left !== undefined ? obj.left = this.left : null;\n        this.right !== undefined ? obj.right = this.right : null;\n        this.top !== undefined ? obj.top = this.top : null;\n        this.bgColor !== undefined ? obj.bgColor = this.bgColor.toObject() : null;\n        this.fgColor !== undefined ? obj.fgColor = this.fgColor.toObject() : null;\n        this.patternType !== undefined ? obj.patternType = this.patternType : null;\n\n        if (this.stops !== undefined) {\n            obj.stop = [];\n            this.stops.forEach((s) => {\n                obj.stops.push(s.toObject());\n            });\n        }\n\n        return obj;\n    }\n\n    /**\n     * @alias Fill.addToXMLele\n     * @desc When generating Workbook output, attaches style to the styles xml file\n     * @func Fill.addToXMLele\n     * @param {xmlbuilder.Element} ele Element object of the xmlbuilder module\n     */\n    addToXMLele(fXML) {\n        let pFill = fXML.ele('patternFill').att('patternType', this.patternType);\n\n        if (this.fgColor instanceof CTColor) {\n            pFill.ele('fgColor').att(this.fgColor.type, this.fgColor[this.fgColor.type]);\n        }\n\n        if (this.bgColor instanceof CTColor) {\n            pFill.ele('bgColor').att(this.bgColor.type, this.bgColor[this.bgColor.type]);\n        }\n    }\n}\n\nmodule.exports = Fill;"],"mappings":"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"}