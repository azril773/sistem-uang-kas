{"version":3,"file":"font.js","names":["xmlbuilder","require","types","Font","opts","color","excelColor","getColor","name","scheme","size","family","fontFamily","validate","vertAlign","charset","condense","extend","bold","italics","outline","shadow","strike","underline","obj","fontXML","fEle","ele","att","undefined","toLowerCase","module","exports"],"sources":["../../../../source/lib/style/classes/font.js"],"sourcesContent":["const xmlbuilder = require('xmlbuilder');\nconst types = require('../../types/index.js');\n\nclass Font {\n    /**\n     * @class Font\n     * @desc Instance of Font with properties\n     * @param {Object} opts Options for Font\n     * @param {String} opts.color HEX color of font\n     * @param {String} opts.name Name of Font. i.e. Calibri\n     * @param {String} opts.scheme Font Scheme. defaults to major\n     * @param {Number} opts.size Pt size of Font\n     * @param {String} opts.family Font Family. defaults to roman\n     * @param {String} opts.vertAlign Specifies font as subscript or superscript\n     * @param {Number} opts.charset Character set of font as defined in ยง18.4.1 charset (Character Set) or standard\n     * @param {Boolean} opts.condense Macintosh compatibility settings to squeeze text together when rendering\n     * @param {Boolean} opts.extend Stretches out the text when rendering\n     * @param {Boolean} opts.bold States whether font should be bold\n     * @param {Boolean} opts.italics States whether font should be in italics\n     * @param {Boolean} opts.outline States whether font should be outlined\n     * @param {Boolean} opts.shadow States whether font should have a shadow\n     * @param {Boolean} opts.strike States whether font should have a strikethrough\n     * @param {Boolean} opts.underline States whether font should be underlined\n     * @retuns {Font}\n     */\n    constructor(opts) {\n        opts = opts ? opts : {};\n\n        typeof opts.color === 'string' ? this.color = types.excelColor.getColor(opts.color) : null;\n        typeof opts.name === 'string' ? this.name = opts.name : null;\n        typeof opts.scheme === 'string' ? this.scheme = opts.scheme : null;\n        typeof opts.size === 'number' ? this.size = opts.size : null;\n        typeof opts.family === 'string' && types.fontFamily.validate(opts.family) === true ? this.family = opts.family : null;\n\n        typeof opts.vertAlign === 'string' ? this.vertAlign = opts.vertAlign : null;\n        typeof opts.charset === 'number' ? this.charset = opts.charset : null;\n\n        typeof opts.condense === 'boolean' ? this.condense = opts.condense : null;\n        typeof opts.extend === 'boolean' ? this.extend = opts.extend : null;\n        typeof opts.bold === 'boolean' ? this.bold = opts.bold : null;\n        typeof opts.italics === 'boolean' ? this.italics = opts.italics : null;\n        typeof opts.outline === 'boolean' ? this.outline = opts.outline : null;\n        typeof opts.shadow === 'boolean' ? this.shadow = opts.shadow : null;\n        typeof opts.strike === 'boolean' ? this.strike = opts.strike : null;\n        typeof opts.underline === 'boolean' ? this.underline = opts.underline : null;\n    }\n\n    /** \n     * @func Font.toObject\n     * @desc Converts the Font instance to a javascript object\n     * @returns {Object}\n     */\n    toObject() {\n        let obj = {};\n\n        typeof this.charset === 'number' ? obj.charset = this.charset : null;\n        typeof this.color === 'string' ? obj.color = this.color : null;\n        typeof this.family === 'string' ? obj.family = this.family : null;\n        typeof this.name === 'string' ? obj.name = this.name : null;\n        typeof this.scheme === 'string' ? obj.scheme = this.scheme : null;\n        typeof this.size === 'number' ? obj.size = this.size : null;\n        typeof this.vertAlign === 'string' ? obj.vertAlign = this.vertAlign : null;\n\n        typeof this.condense === 'boolean' ? obj.condense = this.condense : null;\n        typeof this.extend === 'boolean' ? obj.extend = this.extend : null;\n        typeof this.bold === 'boolean' ? obj.bold = this.bold : null;\n        typeof this.italics === 'boolean' ? obj.italics = this.italics : null;\n        typeof this.outline === 'boolean' ? obj.outline = this.outline : null;\n        typeof this.shadow === 'boolean' ? obj.shadow = this.shadow : null;\n        typeof this.strike === 'boolean' ? obj.strike = this.strike : null;\n        typeof this.underline === 'boolean' ? obj.underline = this.underline : null;\n\n        return obj;\n    }\n\n    /**\n     * @alias Font.addToXMLele\n     * @desc When generating Workbook output, attaches style to the styles xml file\n     * @func Font.addToXMLele\n     * @param {xmlbuilder.Element} ele Element object of the xmlbuilder module\n     */\n    addToXMLele(fontXML) {\n        let fEle = fontXML.ele('font');\n\n        // Place styling elements first to avoid validation errors with .NET validator\n        this.condense === true ? fEle.ele('condense') : null;\n        this.extend === true ? fEle.ele('extend') : null;\n        this.bold === true ? fEle.ele('b') : null;\n        this.italics === true ? fEle.ele('i') : null;\n        this.outline === true ? fEle.ele('outline') : null;\n        this.shadow === true ? fEle.ele('shadow') : null;\n        this.strike === true ? fEle.ele('strike') : null;\n        this.underline === true ? fEle.ele('u') : null;\n        this.vertAlign === true ? fEle.ele('vertAlign') : null;\n\n        fEle.ele('sz').att('val', this.size !== undefined ? this.size : 12);\n        fEle.ele('color').att('rgb', this.color !== undefined ? this.color : 'FF000000');\n        fEle.ele('name').att('val', this.name !== undefined ? this.name : 'Calibri');\n        if (this.family !== undefined) {\n            fEle.ele('family').att('val', types.fontFamily[this.family.toLowerCase()]);\n        }\n        if (this.scheme !== undefined) {\n            fEle.ele('scheme').att('val', this.scheme);\n        }\n\n\n        return true;\n    }\n\n\n}\n\nmodule.exports = Font;"],"mappings":"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"}