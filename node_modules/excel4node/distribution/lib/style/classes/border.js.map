{"version":3,"file":"border.js","names":["types","require","xmlbuilder","CTColor","BorderOrdinal","opts","color","undefined","style","borderStyle","validate","obj","toObject","Border","left","right","top","bottom","diagonal","outline","diagonalDown","diagonalUp","Object","keys","forEach","opt","indexOf","TypeError","borderXML","bXML","ele","att","ord","thisOEle","addToXMLele","module","exports"],"sources":["../../../../source/lib/style/classes/border.js"],"sourcesContent":["const types = require('../../types/index.js');\nconst xmlbuilder = require('xmlbuilder');\nconst CTColor = require('./ctColor.js');\n\nclass BorderOrdinal {\n    constructor(opts) {\n        opts = opts ? opts : {};\n        if (opts.color !== undefined) {\n            this.color = new CTColor(opts.color);\n        }\n        if (opts.style !== undefined) {\n            this.style = types.borderStyle.validate(opts.style) === true ? opts.style : null;\n        }\n    }\n\n    toObject() {\n        let obj = {};\n        if (this.color !== undefined) {\n            obj.color = this.color.toObject();\n        }\n        if (this.style !== undefined) {\n            obj.style = this.style;\n        }\n        return obj;\n    }\n}\n\nclass Border {\n    /** \n     * @class Border\n     * @desc Border object for Style\n     * @param {Object} opts Options for Border object\n     * @param {Object} opts.left Options for left side of Border\n     * @param {String} opts.left.color HEX represenation of color\n     * @param {String} opts.left.style Border style\n     * @param {Object} opts.right Options for right side of Border\n     * @param {String} opts.right.color HEX represenation of color\n     * @param {String} opts.right.style Border style\n     * @param {Object} opts.top Options for top side of Border\n     * @param {String} opts.top.color HEX represenation of color\n     * @param {String} opts.top.style Border style\n     * @param {Object} opts.bottom Options for bottom side of Border\n     * @param {String} opts.bottom.color HEX represenation of color\n     * @param {String} opts.bottom.style Border style\n     * @param {Object} opts.diagonal Options for diagonal side of Border\n     * @param {String} opts.diagonal.color HEX represenation of color\n     * @param {String} opts.diagonal.style Border style\n     * @param {Boolean} opts.outline States whether borders should be applied only to the outside borders of a cell range\n     * @param {Boolean} opts.diagonalDown States whether diagonal border should go from top left to bottom right\n     * @param {Boolean} opts.diagonalUp States whether diagonal border should go from bottom left to top right\n     * @returns {Border}\n     */\n    constructor(opts) {\n        opts = opts ? opts : {};\n        this.left;\n        this.right;\n        this.top;\n        this.bottom;\n        this.diagonal;\n        this.outline;\n        this.diagonalDown;\n        this.diagonalUp;\n\n        Object.keys(opts).forEach((opt) => {\n            if (['outline', 'diagonalDown', 'diagonalUp'].indexOf(opt) >= 0) {\n                if (typeof opts[opt] === 'boolean') {\n                    this[opt] = opts[opt];\n                } else {\n                    throw new TypeError('Border outline option must be of type Boolean');\n                }\n            } else if (['left', 'right', 'top', 'bottom', 'diagonal'].indexOf(opt) < 0) { //TODO: move logic to types folder\n                throw new TypeError(`Invalid key for border declaration ${opt}. Must be one of left, right, top, bottom, diagonal`);\n            } else {\n                this[opt] = new BorderOrdinal(opts[opt]);\n            }\n        });\n    }\n\n    /** \n     * @func Border.toObject\n     * @desc Converts the Border instance to a javascript object\n     * @returns {Object}\n     */\n    toObject() {\n        let obj = {};\n        obj.left;\n        obj.right;\n        obj.top;\n        obj.bottom;\n        obj.diagonal;\n\n        if (this.left !== undefined) {\n            obj.left = this.left.toObject();\n        }\n        if (this.right !== undefined) {\n            obj.right = this.right.toObject();\n        }\n        if (this.top !== undefined) {\n            obj.top = this.top.toObject();\n        }\n        if (this.bottom !== undefined) {\n            obj.bottom = this.bottom.toObject();\n        }\n        if (this.diagonal !== undefined) {\n            obj.diagonal = this.diagonal.toObject();\n        }\n        typeof this.outline === 'boolean' ? obj.outline = this.outline : null;\n        typeof this.diagonalDown === 'boolean' ? obj.diagonalDown = this.diagonalDown : null;\n        typeof this.diagonalUp === 'boolean' ? obj.diagonalUp = this.diagonalUp : null;\n\n        return obj;\n    }\n\n    /**\n     * @alias Border.addToXMLele\n     * @desc When generating Workbook output, attaches style to the styles xml file\n     * @func Border.addToXMLele\n     * @param {xmlbuilder.Element} ele Element object of the xmlbuilder module\n     */\n    addToXMLele(borderXML) {\n        let bXML = borderXML.ele('border');\n        if (this.outline === true) {\n            bXML.att('outline', '1');\n        }\n        if (this.diagonalUp === true) {\n            bXML.att('diagonalUp', '1');\n        }\n        if (this.diagonalDown === true) {\n            bXML.att('diagonalDown', '1');\n        }\n\n        ['left', 'right', 'top', 'bottom', 'diagonal'].forEach((ord) => {\n            let thisOEle = bXML.ele(ord);\n            if (this[ord] !== undefined) {\n                if (this[ord].style !== undefined) {\n                    thisOEle.att('style', this[ord].style);\n                }\n                if (this[ord].color instanceof CTColor) {\n                    this[ord].color.addToXMLele(thisOEle);\n                }\n            }\n        });\n    }\n}\n\nmodule.exports = Border;"],"mappings":"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"}