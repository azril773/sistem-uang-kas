{"version":3,"file":"cell.js","names":["utils","require","Comment","Cell","row","col","r","getExcelAlpha","s","t","f","v","comments","index","val","formula","dt","getExcelTS","sId","ele","is","cEle","att","txt","up","module","exports"],"sources":["../../../source/lib/cell/cell.js"],"sourcesContent":["const utils = require('../utils.js');\nconst Comment = require('../classes/comment');\n\n// ยง18.3.1.4 c (Cell)\nclass Cell {\n    /**\n   * Create an Excel Cell\n   * @private\n   * @param {Number} row Row of cell.\n   * @param {Number} col Column of cell\n   */\n    constructor(row, col) {\n        if (row <= 0) throw 'Row parameter must not be zero or negative.';\n        if (col <= 0) throw 'Col parameter must not be zero or negative.';\n        this.r = `${utils.getExcelAlpha(col)}${row}`; // 'r' attribute\n        this.s = 0; // 's' attribute refering to style index\n        this.t = null; // 't' attribute stating Cell data type - ยง18.18.11 ST_CellType (Cell Type)\n        this.f = null; // 'f' child element used for formulas\n        this.v = null; // 'v' child element for values\n        this.row = row; // used internally throughout code. Does not go into XML\n        this.col = col; // used internally throughout code. Does not go into XML\n    }\n\n    get comment() {\n        return this.comments[this.r];\n    }\n\n    string(index) {\n        this.t = 's';\n        this.v = index;\n        this.f = null;\n    }\n\n    number(val) {\n        this.t = 'n';\n        this.v = val;\n        this.f = null;\n    }\n\n    formula(formula) {\n        this.t = null;\n        this.v = null;\n        this.f = formula;\n    }\n\n    bool(val) {\n        this.t = 'b';\n        this.v = val;\n        this.f = null;\n    }\n\n    date(dt) {\n        this.t = null;\n        this.v = utils.getExcelTS(dt);\n        this.f = null;\n    }\n\n    style(sId) {\n        this.s = sId;\n    }\n\n    addToXMLele(ele) {\n        if (this.v === null && this.is === null) {\n            return;\n        }\n\n        let cEle = ele.ele('c').att('r', this.r).att('s', this.s);\n        if (this.t !== null) {\n            cEle.att('t', this.t);\n        }\n        if (this.f !== null) {\n            cEle.ele('f').txt(this.f).up();\n        }\n        if (this.v !== null) {\n            cEle.ele('v').txt(this.v).up();\n        }\n        cEle.up();\n    }\n}\n\nmodule.exports = Cell;\n"],"mappings":";;;;;;;;AAAA,IAAMA,KAAK,GAAGC,OAAO,CAAC,aAAD,CAArB;;AACA,IAAMC,OAAO,GAAGD,OAAO,CAAC,oBAAD,CAAvB,C,CAEA;;;IACME,I;EACF;AACJ;AACA;AACA;AACA;AACA;EACI,cAAYC,GAAZ,EAAiBC,GAAjB,EAAsB;IAAA;;IAClB,IAAID,GAAG,IAAI,CAAX,EAAc,MAAM,6CAAN;IACd,IAAIC,GAAG,IAAI,CAAX,EAAc,MAAM,6CAAN;IACd,KAAKC,CAAL,aAAYN,KAAK,CAACO,aAAN,CAAoBF,GAApB,CAAZ,SAAuCD,GAAvC,EAHkB,CAG4B;;IAC9C,KAAKI,CAAL,GAAS,CAAT,CAJkB,CAIN;;IACZ,KAAKC,CAAL,GAAS,IAAT,CALkB,CAKH;;IACf,KAAKC,CAAL,GAAS,IAAT,CANkB,CAMH;;IACf,KAAKC,CAAL,GAAS,IAAT,CAPkB,CAOH;;IACf,KAAKP,GAAL,GAAWA,GAAX,CARkB,CAQF;;IAChB,KAAKC,GAAL,GAAWA,GAAX,CATkB,CASF;EACnB;;;;SAED,eAAc;MACV,OAAO,KAAKO,QAAL,CAAc,KAAKN,CAAnB,CAAP;IACH;;;WAED,gBAAOO,KAAP,EAAc;MACV,KAAKJ,CAAL,GAAS,GAAT;MACA,KAAKE,CAAL,GAASE,KAAT;MACA,KAAKH,CAAL,GAAS,IAAT;IACH;;;WAED,gBAAOI,GAAP,EAAY;MACR,KAAKL,CAAL,GAAS,GAAT;MACA,KAAKE,CAAL,GAASG,GAAT;MACA,KAAKJ,CAAL,GAAS,IAAT;IACH;;;WAED,iBAAQK,QAAR,EAAiB;MACb,KAAKN,CAAL,GAAS,IAAT;MACA,KAAKE,CAAL,GAAS,IAAT;MACA,KAAKD,CAAL,GAASK,QAAT;IACH;;;WAED,cAAKD,GAAL,EAAU;MACN,KAAKL,CAAL,GAAS,GAAT;MACA,KAAKE,CAAL,GAASG,GAAT;MACA,KAAKJ,CAAL,GAAS,IAAT;IACH;;;WAED,cAAKM,EAAL,EAAS;MACL,KAAKP,CAAL,GAAS,IAAT;MACA,KAAKE,CAAL,GAASX,KAAK,CAACiB,UAAN,CAAiBD,EAAjB,CAAT;MACA,KAAKN,CAAL,GAAS,IAAT;IACH;;;WAED,eAAMQ,GAAN,EAAW;MACP,KAAKV,CAAL,GAASU,GAAT;IACH;;;WAED,qBAAYC,GAAZ,EAAiB;MACb,IAAI,KAAKR,CAAL,KAAW,IAAX,IAAmB,KAAKS,EAAL,KAAY,IAAnC,EAAyC;QACrC;MACH;;MAED,IAAIC,IAAI,GAAGF,GAAG,CAACA,GAAJ,CAAQ,GAAR,EAAaG,GAAb,CAAiB,GAAjB,EAAsB,KAAKhB,CAA3B,EAA8BgB,GAA9B,CAAkC,GAAlC,EAAuC,KAAKd,CAA5C,CAAX;;MACA,IAAI,KAAKC,CAAL,KAAW,IAAf,EAAqB;QACjBY,IAAI,CAACC,GAAL,CAAS,GAAT,EAAc,KAAKb,CAAnB;MACH;;MACD,IAAI,KAAKC,CAAL,KAAW,IAAf,EAAqB;QACjBW,IAAI,CAACF,GAAL,CAAS,GAAT,EAAcI,GAAd,CAAkB,KAAKb,CAAvB,EAA0Bc,EAA1B;MACH;;MACD,IAAI,KAAKb,CAAL,KAAW,IAAf,EAAqB;QACjBU,IAAI,CAACF,GAAL,CAAS,GAAT,EAAcI,GAAd,CAAkB,KAAKZ,CAAvB,EAA0Ba,EAA1B;MACH;;MACDH,IAAI,CAACG,EAAL;IACH;;;;;;AAGLC,MAAM,CAACC,OAAP,GAAiBvB,IAAjB"}