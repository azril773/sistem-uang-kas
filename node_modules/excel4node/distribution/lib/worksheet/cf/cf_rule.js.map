{"version":3,"file":"cf_rule.js","names":["_reduce","require","_get","CF_RULE_TYPES","CfRule","ruleConfig","type","priority","formula","dxfId","foundType","TypeError","supported","missingProps","requiredProps","list","prop","push","length","join","ele","thisRule","undefined","att","text","up","module","exports"],"sources":["../../../../source/lib/worksheet/cf/cf_rule.js"],"sourcesContent":["const _reduce = require('lodash.reduce');\nconst _get = require('lodash.get');\nconst CF_RULE_TYPES = require('./cf_rule_types');\n\nclass CfRule { // ยง18.3.1.10 cfRule (Conditional Formatting Rule)\n    constructor(ruleConfig) {\n        this.type = ruleConfig.type;\n        this.priority = ruleConfig.priority;\n        this.formula = ruleConfig.formula;\n        this.dxfId = ruleConfig.dxfId;\n\n        let foundType = CF_RULE_TYPES[this.type];\n\n        if (!foundType) {\n            throw new TypeError('\"' + this.type + '\" is not a valid conditional formatting rule type');\n        }\n\n        if (!foundType.supported) {\n            throw new TypeError('Conditional formatting type \"' + this.type + '\" is not yet supported');\n        }\n\n        let missingProps = _reduce(foundType.requiredProps, (list, prop) => {\n            if (_get(this, prop, null) === null) {\n                list.push(prop);\n            }\n            return list;\n        }, []);\n\n        if (missingProps.length) {\n            throw new TypeError('Conditional formatting rule is missing required properties: ' + missingProps.join(', '));\n        }\n    }\n\n    addToXMLele(ele) {\n        let thisRule = ele.ele('cfRule');\n        if (this.type !== undefined) {\n            thisRule.att('type', this.type);\n        }\n        if (this.dxfId !== undefined) {\n            thisRule.att('dxfId', this.dxfId);\n        }\n        if (this.priority !== undefined) {\n            thisRule.att('priority', this.priority);\n        }\n\n        if (this.formula !== undefined) {\n            thisRule.ele('formula').text(this.formula);\n            thisRule.up();\n        }\n        thisRule.up();\n    }\n}\n\n\nmodule.exports = CfRule;"],"mappings":";;;;;;;;AAAA,IAAMA,OAAO,GAAGC,OAAO,CAAC,eAAD,CAAvB;;AACA,IAAMC,IAAI,GAAGD,OAAO,CAAC,YAAD,CAApB;;AACA,IAAME,aAAa,GAAGF,OAAO,CAAC,iBAAD,CAA7B;;IAEMG,M;EAAS;EACX,gBAAYC,UAAZ,EAAwB;IAAA;;IAAA;;IACpB,KAAKC,IAAL,GAAYD,UAAU,CAACC,IAAvB;IACA,KAAKC,QAAL,GAAgBF,UAAU,CAACE,QAA3B;IACA,KAAKC,OAAL,GAAeH,UAAU,CAACG,OAA1B;IACA,KAAKC,KAAL,GAAaJ,UAAU,CAACI,KAAxB;IAEA,IAAIC,SAAS,GAAGP,aAAa,CAAC,KAAKG,IAAN,CAA7B;;IAEA,IAAI,CAACI,SAAL,EAAgB;MACZ,MAAM,IAAIC,SAAJ,CAAc,MAAM,KAAKL,IAAX,GAAkB,mDAAhC,CAAN;IACH;;IAED,IAAI,CAACI,SAAS,CAACE,SAAf,EAA0B;MACtB,MAAM,IAAID,SAAJ,CAAc,kCAAkC,KAAKL,IAAvC,GAA8C,wBAA5D,CAAN;IACH;;IAED,IAAIO,YAAY,GAAGb,OAAO,CAACU,SAAS,CAACI,aAAX,EAA0B,UAACC,IAAD,EAAOC,IAAP,EAAgB;MAChE,IAAId,IAAI,CAAC,KAAD,EAAOc,IAAP,EAAa,IAAb,CAAJ,KAA2B,IAA/B,EAAqC;QACjCD,IAAI,CAACE,IAAL,CAAUD,IAAV;MACH;;MACD,OAAOD,IAAP;IACH,CALyB,EAKvB,EALuB,CAA1B;;IAOA,IAAIF,YAAY,CAACK,MAAjB,EAAyB;MACrB,MAAM,IAAIP,SAAJ,CAAc,iEAAiEE,YAAY,CAACM,IAAb,CAAkB,IAAlB,CAA/E,CAAN;IACH;EACJ;;;;WAED,qBAAYC,GAAZ,EAAiB;MACb,IAAIC,QAAQ,GAAGD,GAAG,CAACA,GAAJ,CAAQ,QAAR,CAAf;;MACA,IAAI,KAAKd,IAAL,KAAcgB,SAAlB,EAA6B;QACzBD,QAAQ,CAACE,GAAT,CAAa,MAAb,EAAqB,KAAKjB,IAA1B;MACH;;MACD,IAAI,KAAKG,KAAL,KAAea,SAAnB,EAA8B;QAC1BD,QAAQ,CAACE,GAAT,CAAa,OAAb,EAAsB,KAAKd,KAA3B;MACH;;MACD,IAAI,KAAKF,QAAL,KAAkBe,SAAtB,EAAiC;QAC7BD,QAAQ,CAACE,GAAT,CAAa,UAAb,EAAyB,KAAKhB,QAA9B;MACH;;MAED,IAAI,KAAKC,OAAL,KAAiBc,SAArB,EAAgC;QAC5BD,QAAQ,CAACD,GAAT,CAAa,SAAb,EAAwBI,IAAxB,CAA6B,KAAKhB,OAAlC;QACAa,QAAQ,CAACI,EAAT;MACH;;MACDJ,QAAQ,CAACI,EAAT;IACH;;;;;;AAILC,MAAM,CAACC,OAAP,GAAiBvB,MAAjB"}