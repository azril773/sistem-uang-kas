{"version":3,"file":"cf_rules_collection.js","names":["CfRule","require","CfRulesCollection","rulesBySqref","Object","keys","length","sqref","ruleConfig","rules","newRule","push","ele","forEach","thisEle","att","rule","addToXMLele","up","module","exports"],"sources":["../../../../source/lib/worksheet/cf/cf_rules_collection.js"],"sourcesContent":["const CfRule = require('./cf_rule');\n\n// -----------------------------------------------------------------------------\n\nclass CfRulesCollection { // ยง18.3.1.18 conditionalFormatting (Conditional Formatting)\n    constructor() {\n        // rules are indexed by cell refs\n        this.rulesBySqref = {};\n    }\n\n    get count() {\n        return Object.keys(this.rulesBySqref).length;\n    }\n\n    add(sqref, ruleConfig) {\n        let rules = this.rulesBySqref[sqref] || [];\n        let newRule = new CfRule(ruleConfig);\n        rules.push(newRule);\n        this.rulesBySqref[sqref] = rules;\n        return this;\n    }\n\n    addToXMLele(ele) {\n        Object.keys(this.rulesBySqref).forEach((sqref) => {\n            let thisEle = ele.ele('conditionalFormatting').att('sqref', sqref);\n            this.rulesBySqref[sqref].forEach((rule) => {\n                rule.addToXMLele(thisEle);\n            });\n            thisEle.up();\n        });\n    }\n}\n\n\nmodule.exports = CfRulesCollection;"],"mappings":";;;;;;;;AAAA,IAAMA,MAAM,GAAGC,OAAO,CAAC,WAAD,CAAtB,C,CAEA;;;IAEMC,iB;EAAoB;EACtB,6BAAc;IAAA;;IACV;IACA,KAAKC,YAAL,GAAoB,EAApB;EACH;;;;SAED,eAAY;MACR,OAAOC,MAAM,CAACC,IAAP,CAAY,KAAKF,YAAjB,EAA+BG,MAAtC;IACH;;;WAED,aAAIC,KAAJ,EAAWC,UAAX,EAAuB;MACnB,IAAIC,KAAK,GAAG,KAAKN,YAAL,CAAkBI,KAAlB,KAA4B,EAAxC;MACA,IAAIG,OAAO,GAAG,IAAIV,MAAJ,CAAWQ,UAAX,CAAd;MACAC,KAAK,CAACE,IAAN,CAAWD,OAAX;MACA,KAAKP,YAAL,CAAkBI,KAAlB,IAA2BE,KAA3B;MACA,OAAO,IAAP;IACH;;;WAED,qBAAYG,GAAZ,EAAiB;MAAA;;MACbR,MAAM,CAACC,IAAP,CAAY,KAAKF,YAAjB,EAA+BU,OAA/B,CAAuC,UAACN,KAAD,EAAW;QAC9C,IAAIO,OAAO,GAAGF,GAAG,CAACA,GAAJ,CAAQ,uBAAR,EAAiCG,GAAjC,CAAqC,OAArC,EAA8CR,KAA9C,CAAd;;QACA,KAAI,CAACJ,YAAL,CAAkBI,KAAlB,EAAyBM,OAAzB,CAAiC,UAACG,IAAD,EAAU;UACvCA,IAAI,CAACC,WAAL,CAAiBH,OAAjB;QACH,CAFD;;QAGAA,OAAO,CAACI,EAAR;MACH,CAND;IAOH;;;;;;AAILC,MAAM,CAACC,OAAP,GAAiBlB,iBAAjB"}